(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const t of i.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&p(t)}).observe(document,{childList:!0,subtree:!0});function d(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(s){if(s.ep)return;s.ep=!0;const i=d(s);fetch(s.href,i)}})();const X=(o,e=4)=>{const d={};return o.forEach(([p,s])=>{const i=document.createElement("canvas"),t=i.getContext("2d"),c=50;i.width=c,i.height=c,t.imageSmoothingEnabled=!1,t.font=`${c}px sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(p,c/2,c/2);const y=c/e,g=document.createElement("canvas");g.width=y,g.height=y;const w=g.getContext("2d");w.imageSmoothingEnabled=!1,w.drawImage(i,0,0,y,y),t.clearRect(0,0,c,c),t.drawImage(g,0,0,y,y,0,0,c,c),t.drawImage(i,0,0);const k=t.getImageData(0,0,c,c),m=k.data;for(let C=0;C<m.length;C+=4){const A=m[C],M=m[C+1],S=m[C+2];A<30&&M<30&&S<30&&(m[C+3]=0)}t.putImageData(k,0,0);const v=i.toDataURL("image/png");d[s]=v}),d},B=()=>({sound:!1,flowers:0,mushrooms:0,turn:0,misses:0,score:0,page:"main",mapPopulated:!1,gridSize:4,selectedType:"mushroom",lockedX:[],lockedY:[],correct:[],incorrect:[]}),N=(o,e)=>({events:{play:()=>L("puzzle"),playWithSound:()=>{e.sound=!0,L("puzzle")}}}),H=o=>{const e=Array(o).fill(null).map(()=>Array(o).fill("")),d=Array(o).fill(null).map(()=>Array(o).fill("")),p=[],s=Math.floor(Math.random()*(o*o/3))+o;for(let i=0;i<s;i++){let t,c;do t=Math.floor(Math.random()*o),c=Math.floor(Math.random()*o);while(e[t][c]==="tree");e[t][c]="tree",d[t][c]="tree",p.push([t,c])}p.forEach(([i,t])=>{const c=[[0,-1],[-1,0],[1,0],[0,1]];for(let[l,y]of c){const g=i+l,w=t+y;$(g,w,o)&&e[g][w]===""&&Math.random()<.7&&(e[g][w]="mushroom")}});for(let i=0;i<o;i++)for(let t=0;t<o;t++)e[i][t]===""&&O(i,t,e,o)&&Math.random()<.7&&(e[i][t]="flower");return{playerSelections:d,board:e}};function O(o,e,d,p){const s=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let[i,t]of s){const c=o+i,l=e+t;if($(c,l,p)&&d[c][l]==="tree")return!1}return!0}function $(o,e,d){return o>=0&&o<d&&e>=0&&e<d}const T=o=>document.querySelector(o);function E(o,e){const d=T(".stats-value.score"),p=T(".stats-value.misses");d.textContent=o,p.textContent=e}const z=(o,e)=>{const d=document.getElementById("particleCanvas"),p=d.getContext("2d");let s;function i(m,v,C){return{x:m,y:v,image:C,size:Math.random()*20+10,speedY:Math.random()*-3-2,speedX:Math.random()*2-1,gravity:.1,opacity:1}}function t(m){m.speedY+=m.gravity,m.x+=m.speedX,m.y+=m.speedY,m.opacity-=.02,m.opacity<0&&(m.opacity=0)}function c(m){p.globalAlpha=m.opacity,p.drawImage(m.image,m.x,m.y,m.size,m.size),p.globalAlpha=1}const l=[];function y(m,v,C,A){const M=new Image;M.src=A,M.onload=()=>{for(let S=0;S<C;S++)l.push(i(m,v,M))}}function g(){p.clearRect(0,0,d.width,d.height);for(let m=l.length-1;m>=0;m--){const v=l[m];t(v),c(v),(v.y>d.height||v.opacity===0)&&l.splice(m,1)}s=requestAnimationFrame(g)}function w(){cancelAnimationFrame(s)}function k(m,v){m&&v?(d.width=m,d.height=v):(d.width=window.innerWidth,d.height=window.innerHeight)}return g(),{initParticles:y,stopParticles:w,setCanvasSize:k}},Y=()=>{const o=[{note:"E5",duration:"sixteenth"},{note:"C5",duration:"sixteenth"},{note:"G4",duration:"sixteenth"}],e={C5:523.25,E5:659.25,G4:392,Rest:0},d={sixteenth:.25},p=.05,s=new(window.AudioContext||window.webkitAudioContext);function i(c,l,y){if(c===0)return;const g=s.createOscillator(),w=s.createGain();g.frequency.setValueAtTime(c,y),g.type="square";const k=.005,m=.01,v=.6,C=.02;w.gain.setValueAtTime(0,y),w.gain.linearRampToValueAtTime(1,y+k),w.gain.linearRampToValueAtTime(v,y+k+m),w.gain.setValueAtTime(v,y+l-C),w.gain.linearRampToValueAtTime(0,y+l),g.connect(w),w.connect(s.destination),g.start(y),g.stop(y+l)}function t(){let c=s.currentTime;o.forEach(l=>{const y=e[l.note],g=p*d[l.duration];y!==void 0&&(i(y,g,c),c+=g)})}return s.resume().then(()=>{console.log("AudioContext is ready for playback")}),{playCoinClinkSound:t}},D=(o,e)=>{const{playCoinClinkSound:d}=Y(),{gridSize:p,images:s}=e,{playerSelections:i,board:t}=H(p),{initParticles:c,stopParticles:l,setCanvasSize:y}=z();function g(h){const a=Array(h[0].length).fill(0),r=Array(h.length).fill(0),n=Array(h.length).fill(0),f=Array(h[0].length).fill(0);for(let x=0;x<h.length;x++)for(let u=0;u<h[x].length;u++)h[x][u]==="flower"?(a[u]++,n[x]++):h[x][u]==="mushroom"&&(f[u]++,r[x]++);return{top:a,right:r,left:n,bottom:f}}const{top:w,right:k,left:m,bottom:v}=g(t);function C(){E(e.score,e.misses);const h=o.querySelector("#game-board");if(h){h.style.gridTemplateColumns=`40px repeat(${t[0].length}, 40px) 40px`,h.style.gridTemplateRows=`40px repeat(${t.length}, 40px) 40px`,h.innerHTML="";for(let a=-1;a<=t.length;a++)for(let r=-1;r<=t[0].length;r++){const n=document.createElement("div");if(n.classList.add("cell"),(e.lockedY.includes(r+"")||e.lockedX.includes(a+""))&&n.classList.add("disabled"),e.correct.some(f=>f[0]===a&&f[1]===r)&&n.classList.add("correct"),e.incorrect.some(f=>f[0]===a&&f[1]===r)&&n.classList.add("incorrect"),r===-1&&a===-1){const f=document.createElement("img");f.src=s.flower3,f.classList.add("tile-image"),n.appendChild(f)}else if(r===t[0].length&&a===t.length){const f=document.createElement("img");f.src=s.mushroom,f.classList.add("tile-image"),n.appendChild(f)}else if(r===t[0].length&&a===-1)n.classList.add("clear-cell");else if(r===-1&&a===t.length)n.classList.add("clear-cell");else if(a===-1&&r>=0&&r<t[0].length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`x--${r}`,n.textContent=w[r];else if(r===-1&&a>=0&&a<t.length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`y--${a}`,n.textContent=m[a];else if(r===t[0].length&&a>=0&&a<t.length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`y--${a}`,n.textContent=k[a];else if(a===t.length&&r>=0&&r<t[0].length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`x--${r}`,n.textContent=v[r];else if(r>=0&&r<t[0].length&&a>=0&&a<t.length){n.setAttribute("data-x",r),n.setAttribute("data-y",a),n.dataset.event="cellClick";const f=document.createElement("img");t[a][r]==="tree"?(f.src=s.tree2,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="tree"):i[a][r]==="flower"?(f.src=s.flower3,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="flower"):i[a][r]==="mushroom"&&(f.src=s.mushroom,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="mushroom")}h.appendChild(n)}y(h.offsetWidth,h.offsetHeight)}}const A=h=>{const a=parseInt(h.target.getAttribute("data-x")),r=parseInt(h.target.getAttribute("data-y"));i[r][a]==="flower"||i[r][a]==="mushroom"?i[r][a]="":e.selectedType&&t[r][a]!=="tree"&&(i[r][a]=e.selectedType),C()},M=()=>{e.selectedType="flower",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='flowerButton']").classList.add("selected")},S=()=>{e.selectedType="mushroom",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='mushroomButton']").classList.add("selected")},q=(h,a)=>{const[r,n]=a.split("--"),{correct:f,incorrect:x}=W(i,t,r==="x"?"y":"x",parseInt(n));r==="y"&&!e.lockedX.includes(n)&&e.lockedX.push(n),r==="x"&&!e.lockedY.includes(n)&&e.lockedY.push(n),e.misses+=x,e.score+=f,e.misses>=13&&(e.gridSize=4,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],l(),L("lose"),e.score=0,e.misses=0,E(e.score,e.misses)),(e.lockedX.length===t.length||e.lockedY.length===t[0].length)&&e.gridSize===13&&e.misses<13&&(e.gridSize=4,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],l(),L("win")),(e.lockedX.length===t.length||e.lockedY.length===t[0].length&&e.misses<13)&&(e.gridSize++,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],l(),L("next")),C()};function W(h,a,r,n){let f=0,x=0;if(r==="x")for(let u=0;u<a[0].length;u++)e.lockedY.includes(u.toString())||(h[n][u]===a[n][u]?(h[n][u]==="flower"||h[n][u]==="mushroom")&&(f++,e.correct.push([n,u]),setTimeout(()=>{c(u*50+50,n*50+50,100,s.star),e.sound&&d()},u*100)):(h[n][u]==="flower"||h[n][u]==="mushroom"||h[n][u]==="")&&(setTimeout(()=>{c(u*50+50,n*50+50,100,s.fail)},u*30),e.incorrect.push([n,u]),x++));else if(r==="y")for(let u=0;u<a.length;u++)e.lockedX.includes(u.toString())||(h[u][n]===a[u][n]?(h[u][n]==="flower"||h[u][n]==="mushroom")&&(f++,e.correct.push([u,n]),setTimeout(()=>{c(n*50+50,u*50+50,100,s.star),e.sound&&d()},u*100)):(h[u][n]==="flower"||h[u][n]==="mushroom"||h[u][n]==="")&&(setTimeout(()=>{c(n*50+50,u*50+50,100,s.fail)},u*50),e.incorrect.push([u,n]),x++));return{correct:f,incorrect:x}}return C(),{events:{flowerButton:M,mushroomButton:S,headerCellClick:q,cellClick:A}}},F=(o,e)=>{const d=()=>L("puzzle"),p=document.querySelector(".next-level");return p.textContent=e.gridSize-3,{events:{continueSearch:d}}},R=[["🌲","tree"],["🌳","tree2"],["🏔️","mountain"],["💧","water"],["🌿","flower"],["🌱","flower2"],["🌺","flower3"],["🪷","flower4"],["🍄","mushroom"],["⭐️","star"],["🌟","star2"],["✨","star3"],["🌙","star4"],["🔴","fail"]],V=(o,e)=>{const{playCoinClinkSound:d}=Y(),p=o.querySelector(".final-score");p.textContent=e.score;let s;const{initParticles:i,stopParticles:t,setCanvasSize:c}=z();c();function l(){for(let g=0;g<10;g++){const w=Math.random()>.5?e.images.star:e.images.star2;i(Math.random()*window.innerWidth,Math.random()*window.innerHeight,10,w)}if(e.sound)for(let g=0;g<5;g++)setTimeout(()=>{d()},g*100);s=setTimeout(l,2e3)}return l(),{events:{continueSearch:()=>{L("puzzle"),clearTimeout(s),t(),e.score=0,e.misses=0,E(e.score,e.misses)}}}},G=()=>({events:{continueSearch:()=>L("puzzle")}}),P=T("#app"),b=B(),K=X(R);b.images=K;b.vWidth=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);b.vHeight=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);b.xOrigin=Math.floor(7e3/2);b.yOrigin=Math.floor(7e3/2);let I;function j(o){const e=document.querySelector(".stars-moon");for(let s=0;s<o;s++)d(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),Math.random()*100/5,b.images.star3);p(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),Math.random()*50,b.images.star4);function d(s,i,t,c){const l=document.createElement("div");l.classList.add("star"),l.style.left=`${s}px`,l.style.top=`${i}px`,l.style.width=`${t}px`,l.style.height=`${t}px`,l.style.backgroundImage=`url(${c})`,l.style.animation=`twinkle ${Math.random()*2+8}s infinite`,e.appendChild(l)}function p(s,i,t,c){const l=document.createElement("div");l.classList.add("moon"),l.style.left=`${s}px`,l.style.top=`${i}px`,l.style.width=`${t}px`,l.style.height=`${t}px`,l.style.backgroundImage=`url(${c})`,e.appendChild(l)}}j(20);const J={main:{html:`
    <div class="general-container">
      <h2>Welcome to the Mushroom Kingdom</h2>
      <p>Find the hidden mushrooms and flowers in the grid. Click on a mushroom or flower to select it. Click on a cell to place it. Click on a cell with a mushroom or flower to remove it.</p>
      <p>Click the button to start the game.</p>
      <p><button class="play" data-event="play">Play</button></p>
      <p><button class="play" data-event="playWithSound">Play With Sound</button></p>
    </div>
    `,funct:N},puzzle:{html:`
    <div class="puzzle-container"><canvas id="particleCanvas"></canvas><div id="game-board"></div></div>
    <div class="button-container"> 
      <button class="button unstyled-button" data-event="flowerButton"><img src="${b.images.flower3}" class="button-image" /> Flower</button>
      <button class="button unstyled-button selected" data-event="mushroomButton"><img src="${b.images.mushroom}" class="button-image" /> Mushroom</button>
    </div>`,funct:D},next:{html:`
    <div class="general-container">
      <h2>Continue your search?</h2>
      <p>Next Level: <span class="next-level"></span></p>
      <button class="continue unstyled-button" data-event="continueSearch">Continue</button>
    </div>
    `,funct:F},win:{html:`
    <canvas id="particleCanvas"></canvas>
    <div class="general-container">
      <h2>You win</h2>
      <h3>Your final score is <span class="final-score"></span>!</h3>
      <button class="continue unstyled-button" data-event="continueSearch">Play again?</button>
    </div>
    `,funct:V},lose:{html:`
    <div class="general-container">
      <h2>You lose</h2>
      <button class="continue unstyled-button" data-event="continueSearch">Play again?</button>
    </div>`,funct:G}};function L(o){b.page=o;const e=J[o];P.innerHTML=e.html,setTimeout(()=>{const d=e.funct(P,b);d!=null&&d.events&&(I=d.events)},0)}P.addEventListener("click",o=>{if(I[o.target.dataset.event]){const e=o.target.dataset.payload?o.target.dataset.payload:null;I[o.target.dataset.event](o,e)}});L("main");
