(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))g(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&g(c)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function g(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}})();const X=(o,e=4)=>{const i={};return o.forEach(([g,a])=>{const s=document.createElement("canvas"),c=s.getContext("2d"),n=50;s.width=n,s.height=n,c.imageSmoothingEnabled=!1,c.font=`${n}px sans-serif`,c.textAlign="center",c.textBaseline="middle",c.fillText(g,n/2,n/2);const p=n/e,v=document.createElement("canvas");v.width=p,v.height=p;const y=v.getContext("2d");y.imageSmoothingEnabled=!1,y.drawImage(s,0,0,p,p),c.clearRect(0,0,n,n),c.drawImage(v,0,0,p,p,0,0,n,n),c.drawImage(s,0,0);const M=c.getImageData(0,0,n,n),m=M.data;for(let b=0;b<m.length;b+=4){const S=m[b],T=m[b+1],L=m[b+2];S<30&&T<30&&L<30&&(m[b+3]=0)}c.putImageData(M,0,0);const w=s.toDataURL("image/png");i[a]=w}),i},H=()=>({sound:!1,flowers:0,mushrooms:0,turn:0,misses:0,score:0,page:"main",mapPopulated:!1,gridSize:4,selectedType:"mushroom",lockedX:[],lockedY:[],correct:[],incorrect:[]}),O=(o,e)=>({events:{play:()=>x("puzzle"),playWithSound:()=>{e.sound=!0,x("puzzle")},scores:()=>{x("scores")}}}),F=o=>{const e=Array(o).fill(null).map(()=>Array(o).fill("")),i=Array(o).fill(null).map(()=>Array(o).fill("")),g=[],a=Math.floor(Math.random()*(o*o/3))+o;for(let s=0;s<a;s++){let c,n;do c=Math.floor(Math.random()*o),n=Math.floor(Math.random()*o);while(e[c][n]==="tree");e[c][n]="tree",i[c][n]="tree",g.push([c,n])}g.forEach(([s,c])=>{const n=[[0,-1],[-1,0],[1,0],[0,1]];for(let[l,p]of n){const v=s+l,y=c+p;$(v,y,o)&&e[v][y]===""&&Math.random()<.7&&(e[v][y]="mushroom")}});for(let s=0;s<o;s++)for(let c=0;c<o;c++)e[s][c]===""&&R(s,c,e,o)&&Math.random()<.7&&(e[s][c]="flower");return{playerSelections:i,board:e}};function R(o,e,i,g){const a=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let[s,c]of a){const n=o+s,l=e+c;if($(n,l,g)&&i[n][l]==="tree")return!1}return!0}function $(o,e,i){return o>=0&&o<i&&e>=0&&e<i}const A=o=>document.querySelector(o);function E(o,e){const i=A(".stats-value.score"),g=A(".stats-value.misses");i.textContent=o,g.textContent=e}const z=(o,e)=>{const i=document.getElementById("particleCanvas"),g=i.getContext("2d");let a;function s(m,w,b){return{x:m,y:w,image:b,size:Math.random()*20+10,speedY:Math.random()*-3-2,speedX:Math.random()*2-1,gravity:.1,opacity:1}}function c(m){m.speedY+=m.gravity,m.x+=m.speedX,m.y+=m.speedY,m.opacity-=.02,m.opacity<0&&(m.opacity=0)}function n(m){g.globalAlpha=m.opacity,g.drawImage(m.image,m.x,m.y,m.size,m.size),g.globalAlpha=1}const l=[];function p(m,w,b,S){const T=new Image;T.src=S,T.onload=()=>{for(let L=0;L<b;L++)l.push(s(m,w,T))}}function v(){g.clearRect(0,0,i.width,i.height);for(let m=l.length-1;m>=0;m--){const w=l[m];c(w),n(w),(w.y>i.height||w.opacity===0)&&l.splice(m,1)}a=requestAnimationFrame(v)}function y(){cancelAnimationFrame(a)}function M(m,w){m&&w?(i.width=m,i.height=w):(i.width=window.innerWidth,i.height=window.innerHeight)}return v(),{initParticles:p,stopParticles:y,setCanvasSize:M}},Y=()=>{const o=[{note:"E5",duration:"sixteenth"},{note:"C5",duration:"sixteenth"},{note:"G4",duration:"sixteenth"}],e={C5:523.25,E5:659.25,G4:392,Rest:0},i={sixteenth:.25},g=.05,a=new(window.AudioContext||window.webkitAudioContext);function s(n,l,p){if(n===0)return;const v=a.createOscillator(),y=a.createGain();v.frequency.setValueAtTime(n,p),v.type="square";const M=.005,m=.01,w=.6,b=.02;y.gain.setValueAtTime(0,p),y.gain.linearRampToValueAtTime(1,p+M),y.gain.linearRampToValueAtTime(w,p+M+m),y.gain.setValueAtTime(w,p+l-b),y.gain.linearRampToValueAtTime(0,p+l),v.connect(y),y.connect(a.destination),v.start(p),v.stop(p+l)}function c(){let n=a.currentTime;o.forEach(l=>{const p=e[l.note],v=g*i[l.duration];p!==void 0&&(s(p,v,n),n+=v)})}return a.resume().then(()=>{console.log("AudioContext is ready for playback")}),{playCoinClinkSound:c}},D=(o,e)=>{const i=localStorage.getItem("scores"),{playCoinClinkSound:g}=Y(),{gridSize:a,images:s}=e,{playerSelections:c,board:n}=F(a),{initParticles:l,stopParticles:p,setCanvasSize:v}=z();function y(h){const d=Array(h[0].length).fill(0),u=Array(h.length).fill(0),t=Array(h.length).fill(0),f=Array(h[0].length).fill(0);for(let C=0;C<h.length;C++)for(let r=0;r<h[C].length;r++)h[C][r]==="flower"?(d[r]++,t[C]++):h[C][r]==="mushroom"&&(f[r]++,u[C]++);return{top:d,right:u,left:t,bottom:f}}const{top:M,right:m,left:w,bottom:b}=y(n);function S(){E(e.score,e.misses);const h=o.querySelector("#game-board");if(h){h.style.gridTemplateColumns=`50px repeat(${n[0].length}, 50px) 50px`,h.style.gridTemplateRows=`50px repeat(${n.length}, 50px) 50px`,h.innerHTML="";for(let d=-1;d<=n.length;d++)for(let u=-1;u<=n[0].length;u++){const t=document.createElement("div");if(t.classList.add("cell"),(e.lockedY.includes(u+"")||e.lockedX.includes(d+""))&&t.classList.add("disabled"),e.correct.some(f=>f[0]===d&&f[1]===u)&&t.classList.add("correct"),e.incorrect.some(f=>f[0]===d&&f[1]===u)&&t.classList.add("incorrect"),u===-1&&d===-1){const f=document.createElement("img");f.src=s.flower3,f.classList.add("tile-image"),t.appendChild(f)}else if(u===n[0].length&&d===n.length){const f=document.createElement("img");f.src=s.mushroom,f.classList.add("tile-image"),t.appendChild(f)}else if(u===n[0].length&&d===-1)t.classList.add("clear-cell");else if(u===-1&&d===n.length)t.classList.add("clear-cell");else if(d===-1&&u>=0&&u<n[0].length)t.classList.add("header-cell"),t.dataset.event="headerCellClick",t.dataset.payload=`x--${u}`,t.textContent=M[u];else if(u===-1&&d>=0&&d<n.length)t.classList.add("header-cell"),t.dataset.event="headerCellClick",t.dataset.payload=`y--${d}`,t.textContent=w[d];else if(u===n[0].length&&d>=0&&d<n.length)t.classList.add("header-cell"),t.dataset.event="headerCellClick",t.dataset.payload=`y--${d}`,t.textContent=m[d];else if(d===n.length&&u>=0&&u<n[0].length)t.classList.add("header-cell"),t.dataset.event="headerCellClick",t.dataset.payload=`x--${u}`,t.textContent=b[u];else if(u>=0&&u<n[0].length&&d>=0&&d<n.length){t.setAttribute("data-x",u),t.setAttribute("data-y",d),t.dataset.event="cellClick";const f=document.createElement("img");n[d][u]==="tree"?(f.src=s.tree2,f.classList.add("tile-image"),t.appendChild(f),t.dataset.type="tree"):c[d][u]==="flower"?(f.src=s.flower3,f.classList.add("tile-image"),t.appendChild(f),t.dataset.type="flower"):c[d][u]==="mushroom"&&(f.src=s.mushroom,f.classList.add("tile-image"),t.appendChild(f),t.dataset.type="mushroom")}h.appendChild(t)}v(h.offsetWidth,h.offsetHeight)}}const T=h=>{const d=parseInt(h.target.getAttribute("data-x")),u=parseInt(h.target.getAttribute("data-y"));c[u][d]==="flower"||c[u][d]==="mushroom"?c[u][d]="":e.selectedType&&n[u][d]!=="tree"&&(c[u][d]=e.selectedType),S()},L=()=>{e.selectedType="flower",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='flowerButton']").classList.add("selected")},B=()=>{e.selectedType="mushroom",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='mushroomButton']").classList.add("selected")},q=(h,d)=>{const[u,t]=d.split("--"),{correct:f,incorrect:C}=W(c,n,u==="x"?"y":"x",parseInt(t));u==="y"&&!e.lockedX.includes(t)&&e.lockedX.push(t),u==="x"&&!e.lockedY.includes(t)&&e.lockedY.push(t),e.misses+=C,e.score+=f,e.misses>=13&&(e.gridSize=4,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],p(),x("lose"),r(),e.score=0,e.misses=0,e.selectedType="mushroom",E(e.score,e.misses)),(e.lockedX.length===n.length||e.lockedY.length===n[0].length)&&e.gridSize===13&&e.misses<13&&(e.gridSize=4,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],e.selectedType="mushroom",r(),p(),x("win")),(e.lockedX.length===n.length||e.lockedY.length===n[0].length&&e.misses<13)&&(e.gridSize++,e.lockedX=[],e.lockedY=[],e.correct=[],e.incorrect=[],e.selectedType="mushroom",p(),x("next")),S();function r(){const N=[...i?JSON.parse(i):[],e.score];localStorage.setItem("scores",JSON.stringify(N))}};function W(h,d,u,t){let f=0,C=0;if(u==="x")for(let r=0;r<d[0].length;r++)e.lockedY.includes(r.toString())||(h[t][r]===d[t][r]?(h[t][r]==="flower"||h[t][r]==="mushroom")&&(f++,e.correct.push([t,r]),setTimeout(()=>{l(r*60+60,t*60+60,100,s.star),e.sound&&g()},r*50)):(h[t][r]==="flower"||h[t][r]==="mushroom"||h[t][r]==="")&&(setTimeout(()=>{l(r*60+60,t*60+60,100,s.fail)},r*30),e.incorrect.push([t,r]),C++));else if(u==="y")for(let r=0;r<d.length;r++)e.lockedX.includes(r.toString())||(h[r][t]===d[r][t]?(h[r][t]==="flower"||h[r][t]==="mushroom")&&(f++,e.correct.push([r,t]),setTimeout(()=>{l(t*60+60,r*60+60,100,s.star),e.sound&&g()},r*50)):(h[r][t]==="flower"||h[r][t]==="mushroom"||h[r][t]==="")&&(setTimeout(()=>{l(t*60+60,r*60+60,100,s.fail)},r*50),e.incorrect.push([r,t]),C++));return{correct:f,incorrect:C}}return S(),{events:{flowerButton:L,mushroomButton:B,headerCellClick:q,cellClick:T}}},V=(o,e)=>{const i=()=>x("puzzle"),g=document.querySelector(".next-level");return g.textContent=e.gridSize-3,{events:{continueSearch:i}}},G=[["ðŸŒ³","tree2"],["ðŸŒº","flower3"],["ðŸ„","mushroom"],["â­ï¸","star"],["ðŸŒŸ","star2"],["âœ¨","star3"],["ðŸŒ™","star4"],["ðŸ”´","fail"]],J=(o,e)=>{const i=()=>x("main"),{playCoinClinkSound:g}=Y(),a=o.querySelector(".final-score");a.textContent=e.score;let s;const{initParticles:c,stopParticles:n,setCanvasSize:l}=z();l();function p(){for(let y=0;y<10;y++){const M=Math.random()>.5?e.images.star:e.images.star2;c(Math.random()*window.innerWidth,Math.random()*window.innerHeight,10,M)}if(e.sound)for(let y=0;y<5;y++)setTimeout(()=>{g()},y*100);s=setTimeout(p,2e3)}return p(),{events:{continueSearch:()=>{x("puzzle"),clearTimeout(s),n(),e.score=0,e.misses=0,E(e.score,e.misses)},backToMain:i}}},j=()=>({events:{continueSearch:()=>x("puzzle"),backToMain:()=>x("main")}}),U=()=>{const o=()=>x("main"),e=localStorage.getItem("scores"),i=JSON.parse(e),g=i?[...new Set(i)].sort((a,s)=>s-a):[];return document.querySelector(".scores-list").innerHTML=g.map(a=>`<li><h3>${a}</h3></li>`).join(""),{events:{backToMain:o}}},I=A("#app"),k=H(),K=X(G);k.images=K;k.vWidth=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);k.vHeight=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);k.xOrigin=Math.floor(7e3/2);k.yOrigin=Math.floor(7e3/2);let P;function Q(o){const e=document.querySelector(".stars-moon");for(let a=0;a<o;a++)i(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),Math.random()*100/5,k.images.star3);g(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),50,k.images.star4);function i(a,s,c,n){const l=document.createElement("div");l.classList.add("star"),l.style.left=`${a}px`,l.style.top=`${s}px`,l.style.width=`${c}px`,l.style.height=`${c}px`,l.style.backgroundImage=`url(${n})`,l.style.animation=`twinkle ${Math.random()*2+8}s infinite`,e.appendChild(l)}function g(a,s,c,n){const l=document.createElement("div");l.classList.add("moon"),l.style.left=`${a}px`,l.style.top=`${s}px`,l.style.width=`${c}px`,l.style.height=`${c}px`,l.style.backgroundImage=`url(${n})`,e.appendChild(l)}}Q(20);const Z={main:{html:`
    <div class="general-container">
      <h2>Miles to Mend</h2>
      <h4>Goal: Find all mushrooms and flowers correctly over 9 levels without getting 13 incorrect answers.</h4>
      <p><button class="unstyled-button" data-event="play">Play</button> <button class="unstyled-button" data-event="playWithSound">Play With Sound</button> <button class="unstyled-button" data-event="scores">Hi Scores</button></p>
      <p>
      <h4>Rules:</h4>
      <ul>
        <li>Collect your ingredients by selecting the ingredient tab (mushroom or flower) and clicking an empty square on the board.</li>
        <li>The numbers along the borders show how many mushrooms and flowers to include in each row and column. Bottom and right show how many mushrooms. Top and left show how many flowers.</li>
        <li>Flowers need sun: they must not be placed next to trees.</li>
        <li>Mushrooms need shade: they must be placed next to trees.</li>
        <li>To remove an ingredient from the board, click on it.</li>
        <li>When you've finished collecting, click a border number to score that row or column.</li>
        <li>When all spaces on the grid are scored, if you have fewer than 13 incorrect placements you progress to the next level.</li>
        <li>Beat 9 levels to win!</li>
      </ul>
      <p>A game by <a href="https://github.com/vivianeasley">Vivian Easley</a></p>
      </p>
    </div>
    `,funct:O},puzzle:{html:`
    <div class="puzzle-container"><canvas id="particleCanvas"></canvas><div id="game-board"></div></div>
    <div class="button-container"> 
      <button class="button unstyled-button" data-event="flowerButton"><img src="${k.images.flower3}" class="button-image" /> Flower</button>
      <button class="button unstyled-button selected" data-event="mushroomButton"><img src="${k.images.mushroom}" class="button-image" /> Mushroom</button>
    </div>`,funct:D},next:{html:`
    <div class="general-container">
      <h2>Continue your search?</h2>
      <p>Next Level: <span class="next-level"></span></p>
      <button class="continue unstyled-button" data-event="continueSearch">Continue</button>
    </div>
    `,funct:V},win:{html:`
    <canvas id="particleCanvas"></canvas>
    <div class="general-container">
      <h2>You win</h2>
      <h3>Your final score is <span class="final-score"></span>!</h3>
      <p>
        <button class="unstyled-button" data-event="backToMain">Back to Main</button>
      </p>
      <p>
        <button class="continue unstyled-button" data-event="continueSearch">Play again</button>
      </p>
    </div>
    `,funct:J},lose:{html:`
    <div class="general-container">
      <h2>You lose</h2>
      <p>
        <button class="unstyled-button" data-event="backToMain">Back to Main</button>
      </p>
      <p>
        <button class="continue unstyled-button" data-event="continueSearch">Play again</button>
      </p>
    </div>`,funct:j},scores:{html:`
    <div class="general-container">
      <p>
        <button class="unstyled-button" data-event="backToMain">Back to Main</button>
      </p>
      <h2>High Scores</h2>
      <p>
        <ol class="scores-list">
        </ol>
      </p>
    </div>`,funct:U}};function x(o){k.page=o;const e=Z[o];I.innerHTML=e.html,setTimeout(()=>{const i=e.funct(I,k);i!=null&&i.events&&(P=i.events)},0)}I.addEventListener("click",o=>{if(P[o.target.dataset.event]){const e=o.target.dataset.payload?o.target.dataset.payload:null;P[o.target.dataset.event](o,e)}});function _(o){const e=document.getElementById("favicon");e&&(e.href=o)}_(k.images.star4);x("main");
