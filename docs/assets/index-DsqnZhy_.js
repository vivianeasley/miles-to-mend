(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const t of i)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function d(i){const t={};return i.integrity&&(t.integrity=i.integrity),i.referrerPolicy&&(t.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?t.credentials="include":i.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(i){if(i.ep)return;i.ep=!0;const t=d(i);fetch(i.href,t)}})();const B=(o,e=4)=>{const d={};return o.forEach(([c,i])=>{const t=document.createElement("canvas"),a=t.getContext("2d"),s=50;t.width=s,t.height=s,a.imageSmoothingEnabled=!1,a.font=`${s}px sans-serif`,a.textAlign="center",a.textBaseline="middle",a.fillText(c,s/2,s/2);const p=s/e,y=document.createElement("canvas");y.width=p,y.height=p;const b=y.getContext("2d");b.imageSmoothingEnabled=!1,b.drawImage(t,0,0,p,p),a.clearRect(0,0,s,s),a.drawImage(y,0,0,p,p,0,0,s,s),a.drawImage(t,0,0);const k=a.getImageData(0,0,s,s),u=k.data;for(let x=0;x<u.length;x+=4){const E=u[x],L=u[x+1],P=u[x+2];E<30&&L<30&&P<30&&(u[x+3]=0)}a.putImageData(k,0,0);const g=t.toDataURL("image/png");d[i]=g}),d},q=()=>({flowers:0,mushrooms:0,turn:0,misses:0,score:0,page:"main",mapPopulated:!1,gridSize:4,selectedType:"mushroom",lockedX:[],lockedY:[]}),H=()=>({events:{play:()=>M("puzzle")}}),O=o=>{const e=Array(o).fill(null).map(()=>Array(o).fill("")),d=Array(o).fill(null).map(()=>Array(o).fill("")),c=[],i=Math.floor(Math.random()*(o*o/3))+o;for(let t=0;t<i;t++){let a,s;do a=Math.floor(Math.random()*o),s=Math.floor(Math.random()*o);while(e[a][s]==="tree");e[a][s]="tree",d[a][s]="tree",c.push([a,s])}c.forEach(([t,a])=>{const s=[[0,-1],[-1,0],[1,0],[0,1]];for(let[v,p]of s){const y=t+v,b=a+p;z(y,b,o)&&e[y][b]===""&&Math.random()<.7&&(e[y][b]="mushroom")}});for(let t=0;t<o;t++)for(let a=0;a<o;a++)e[t][a]===""&&W(t,a,e,o)&&Math.random()<.7&&(e[t][a]="flower");return{playerSelections:d,board:e}};function W(o,e,d,c){const i=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];for(let[t,a]of i){const s=o+t,v=e+a;if(z(s,v,c)&&d[s][v]==="tree")return!1}return!0}function z(o,e,d){return o>=0&&o<d&&e>=0&&e<d}const $=o=>document.querySelector(o);function I(o,e){console.log("updateScoreMisses",o,e);const d=$(".stats-value.score"),c=$(".stats-value.misses");d.textContent=o,c.textContent=e}const Y=(o,e)=>{const d=document.getElementById("particleCanvas"),c=d.getContext("2d");let i;function t(u,g,x){return{x:u,y:g,image:x,size:Math.random()*20+10,speedY:Math.random()*-3-2,speedX:Math.random()*2-1,gravity:.1,opacity:1}}function a(u){u.speedY+=u.gravity,u.x+=u.speedX,u.y+=u.speedY,u.opacity-=.02,u.opacity<0&&(u.opacity=0)}function s(u){c.globalAlpha=u.opacity,c.drawImage(u.image,u.x,u.y,u.size,u.size),c.globalAlpha=1}const v=[];function p(u,g,x,E){const L=new Image;L.src=E,L.onload=()=>{for(let P=0;P<x;P++)v.push(t(u,g,L))}}function y(){c.clearRect(0,0,d.width,d.height);for(let u=v.length-1;u>=0;u--){const g=v[u];a(g),s(g),(g.y>d.height||g.opacity===0)&&v.splice(u,1)}i=requestAnimationFrame(y)}function b(){cancelAnimationFrame(i)}function k(u,g){u&&g?(d.width=u,d.height=g):(d.width=window.innerWidth,d.height=window.innerHeight)}return y(),{initParticles:p,stopParticles:b,setCanvasSize:k}},N=(o,e)=>{const{gridSize:d,images:c}=e,{playerSelections:i,board:t}=O(d),{initParticles:a,stopParticles:s,setCanvasSize:v}=Y();function p(m){const l=Array(m[0].length).fill(0),r=Array(m.length).fill(0),n=Array(m.length).fill(0),f=Array(m[0].length).fill(0);for(let w=0;w<m.length;w++)for(let h=0;h<m[w].length;h++)m[w][h]==="flower"?(l[h]++,n[w]++):m[w][h]==="mushroom"&&(f[h]++,r[w]++);return{top:l,right:r,left:n,bottom:f}}const{top:y,right:b,left:k,bottom:u}=p(t);function g(){I(e.score,e.misses);const m=o.querySelector("#game-board");if(m){m.style.gridTemplateColumns=`40px repeat(${t[0].length}, 40px) 40px`,m.style.gridTemplateRows=`40px repeat(${t.length}, 40px) 40px`,m.innerHTML="";for(let l=-1;l<=t.length;l++)for(let r=-1;r<=t[0].length;r++){const n=document.createElement("div");if(n.classList.add("cell"),(e.lockedY.includes(r+"")||e.lockedX.includes(l+""))&&n.classList.add("disabled"),r===-1&&l===-1){const f=document.createElement("img");f.src=c.flower3,f.classList.add("tile-image"),n.appendChild(f)}else if(r===t[0].length&&l===t.length){const f=document.createElement("img");f.src=c.mushroom,f.classList.add("tile-image"),n.appendChild(f)}else if(r===t[0].length&&l===-1)n.classList.add("clear-cell");else if(r===-1&&l===t.length)n.classList.add("clear-cell");else if(l===-1&&r>=0&&r<t[0].length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`x--${r}`,n.textContent=y[r];else if(r===-1&&l>=0&&l<t.length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`y--${l}`,n.textContent=k[l];else if(r===t[0].length&&l>=0&&l<t.length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`y--${l}`,n.textContent=b[l];else if(l===t.length&&r>=0&&r<t[0].length)n.classList.add("header-cell"),n.dataset.event="headerCellClick",n.dataset.payload=`x--${r}`,n.textContent=u[r];else if(r>=0&&r<t[0].length&&l>=0&&l<t.length){n.setAttribute("data-x",r),n.setAttribute("data-y",l),n.dataset.event="cellClick";const f=document.createElement("img");t[l][r]==="tree"?(f.src=c.tree2,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="tree"):i[l][r]==="flower"?(f.src=c.flower3,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="flower"):i[l][r]==="mushroom"&&(f.src=c.mushroom,f.classList.add("tile-image"),n.appendChild(f),n.dataset.type="mushroom")}m.appendChild(n)}v(m.offsetWidth,m.offsetHeight)}}const x=m=>{const l=parseInt(m.target.getAttribute("data-x")),r=parseInt(m.target.getAttribute("data-y"));i[r][l]==="flower"||i[r][l]==="mushroom"?(console.log("removing",m.target),i[r][l]=""):e.selectedType&&t[r][l]!=="tree"&&(i[r][l]=e.selectedType),g()},E=()=>{e.selectedType="flower",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='flowerButton']").classList.add("selected")},L=()=>{e.selectedType="mushroom",o.querySelector(".button.selected").classList.remove("selected"),o.querySelector(".button[data-event='mushroomButton']").classList.add("selected")},P=(m,l)=>{const[r,n]=l.split("--"),{correct:f,incorrect:w}=X(i,t,r==="x"?"y":"x",parseInt(n));r==="y"&&!e.lockedX.includes(n)&&e.lockedX.push(n),r==="x"&&!e.lockedY.includes(n)&&e.lockedY.push(n),e.misses+=w,e.score+=f,e.misses>=13&&(e.gridSize=4,e.lockedX=[],e.lockedY=[],s(),M("lose"),e.score=0,e.misses=0,I(e.score,e.misses)),(e.lockedX.length===t.length||e.lockedY.length===t[0].length)&&e.gridSize===13&&e.misses<13&&(console.log("win",e.gridSize,e.misses),e.gridSize=4,e.lockedX=[],e.lockedY=[],s(),M("win"),e.score=0,e.misses=0,I(e.score,e.misses)),(e.lockedX.length===t.length||e.lockedY.length===t[0].length&&e.misses<13)&&(e.gridSize++,e.lockedX=[],e.lockedY=[],s(),M("next")),g()};function X(m,l,r,n){let f=0,w=0;if(console.log(m),r==="x")for(let h=0;h<l[0].length;h++)m[n][h]===l[n][h]?(m[n][h]==="flower"||m[n][h]==="mushroom")&&(f++,a(h*50+50,n*50+50,100,c.star)):(m[n][h]==="flower"||m[n][h]==="mushroom"||m[n][h]==="")&&(a(h*50+50,n*50+50,100,c.fail),w++);else if(r==="y")for(let h=0;h<l.length;h++)m[h][n]===l[h][n]?(m[h][n]==="flower"||m[h][n]==="mushroom")&&(f++,a(n*50+50,h*50+50,100,c.star)):(m[h][n]==="flower"||m[h][n]==="mushroom"||m[h][n]==="")&&(a(n*50+50,h*50+50,100,c.fail),w++);return{correct:f,incorrect:w}}return g(),{events:{flowerButton:E,mushroomButton:L,headerCellClick:P,cellClick:x}}},D=(o,e)=>{const d=()=>M("puzzle"),c=document.querySelector(".next-level");return c.textContent=e.gridSize-3,{events:{continueSearch:d}}},F=[["ðŸŒ²","tree"],["ðŸŒ³","tree2"],["ðŸ”ï¸","mountain"],["ðŸ’§","water"],["ðŸŒ¿","flower"],["ðŸŒ±","flower2"],["ðŸŒº","flower3"],["ðŸª·","flower4"],["ðŸ„","mushroom"],["â­ï¸","star"],["ðŸŒŸ","star2"],["âœ¨","star3"],["ðŸŒ™","star4"],["ðŸ”´","fail"]],R=(o,e)=>{const d=o.querySelector(".final-score");d.textContent=e.score;let c;const{initParticles:i,stopParticles:t,setCanvasSize:a}=Y();a();function s(){for(let p=0;p<10;p++){const y=Math.random()>.5?e.images.star:e.images.star2;i(Math.random()*window.innerWidth,Math.random()*window.innerHeight,10,y)}c=setTimeout(s,2e3)}return s(),{events:{continueSearch:()=>{M("puzzle"),clearTimeout(c),t()}}}},j=()=>({events:{continueSearch:()=>M("puzzle")}}),A=$("#app"),C=q(),T=B(F);console.log(T["1tree"]);C.images=T;C.vWidth=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);C.vHeight=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);C.xOrigin=Math.floor(7e3/2);C.yOrigin=Math.floor(7e3/2);let S;function K(o){for(let c=0;c<o;c++)e(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),Math.random()*100/5,C.images.star3);d(Math.random()*window.innerWidth,Math.random()*(window.innerHeight/1.5),Math.random()*50,C.images.star4);function e(c,i,t,a){const s=document.createElement("div");s.classList.add("star"),s.style.left=`${c}px`,s.style.top=`${i}px`,s.style.width=`${t}px`,s.style.height=`${t}px`,s.style.backgroundImage=`url(${a})`,s.style.animation=`twinkle ${Math.random()*2+8}s infinite`,document.body.appendChild(s)}function d(c,i,t,a){const s=document.createElement("div");s.classList.add("moon"),s.style.left=`${c}px`,s.style.top=`${i}px`,s.style.width=`${t}px`,s.style.height=`${t}px`,s.style.backgroundImage=`url(${a})`,document.body.appendChild(s)}}K(20);const J={main:{html:`
    <div class="general-container">
      <h2>Welcome to the Mushroom Kingdom</h2>
      <button class="play" data-event="play">Play</button>
    </div>
    `,funct:H},puzzle:{html:`
    <div class="puzzle-container"><canvas id="particleCanvas"></canvas><div id="game-board"></div></div>
    <div class="button-container"> 
      <button class="button" data-event="flowerButton"><img src="${C.images.flower3}" class="button-image" /> Flower</button>
      <button class="button selected" data-event="mushroomButton"><img src="${C.images.mushroom}" class="button-image" /> Mushroom</button>
    </div>`,funct:N},next:{html:`
    <div class="general-container">
      <h2>Continue your search?</h2>
      <p>Next Level: <span class="next-level"></span></p>
      <button class="continue" data-event="continueSearch">Continue</button>
    </div>
    `,funct:D},win:{html:`
    <canvas id="particleCanvas"></canvas>
    <div class="general-container">
      <h2>You win</h2>
      <h3>Your final score is <span class="final-score"></span>!</h3>
      <button class="continue" data-event="continueSearch">Play again?</button>
    </div>
    `,funct:R},lose:{html:`
    <div class="general-container">
      <h2>You lose</h2>
      <button class="continue" data-event="continueSearch">Play again?</button>
    </div>`,funct:j}};function M(o){C.page=o;const e=J[o];console.log(e),A.innerHTML=e.html,setTimeout(()=>{const d=e.funct(A,C);d!=null&&d.events&&(console.log(d.events),S=d.events)},0)}A.addEventListener("click",o=>{if(S[o.target.dataset.event]){const e=o.target.dataset.payload?o.target.dataset.payload:null;S[o.target.dataset.event](o,e)}});M("main");
